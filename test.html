<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test-Dashboard - deepdive.Jette</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Stile sind jetzt in style.css enthalten -->
</head>
<body>
    <header>
        <h1><a href="index.html" title="Zurück zur Startseite">deepdive.Jette - Tests</a></h1>
        <nav>
            <ul>
                <li><a href="index.html">Start</a></li>
                <li><a href="info.html">Info</a></li>
                <li><a href="account.html">Account</a></li>
                 <li><a href="test.html" class="active">Testseite</a></li>
            </ul>
            <!-- Netlify Identity Login/Logout -->
            <div class="netlify-identity-menu-container" data-netlify-identity-menu></div>
        </nav>
    </header>

    <main>
        <h2 class="glitch-text" data-text="Systemdiagnose">Systemdiagnose</h2>
        <p>Diese Seite führt automatische Tests für die deepdive.Jette-Website durch und überprüft die Konfiguration.</p>

        <div class="test-container">
            <h3>Identity & Redirect Tests</h3>
            <div class="test-results" id="identity-test-results">
                <p>Prüfe Authentifizierungssystem...</p>
            </div>
            <div class="func-test-container">
                <h4 class="glitch-text" data-text="Funktionale Redirect-Logik">Funktionale Redirect-Logik</h4>
                <p>Überprüfung der Weiterleitungslogik für definierte Benutzerrollen [ACCESS_LEVELS].</p>
                <div class="test-results" id="func-test-results">
                    <p>Warte auf Initialisierung oder manuellen Start...</p>
                </div>
                <div class="test-actions">
                    <button class="test-button" id="run-func-tests">[Run Functional Tests]</button>
                </div>
            </div>
        </div>

        <div class="test-container">
            <h3>DOM Struktur & Elemente</h3>
            <div class="test-results" id="dom-test-results">
                <p>Analysiere Seitenstruktur...</p>
            </div>
        </div>

        <div class="test-container">
            <h3>Rollen & Berechtigungen</h3>
            <div class="test-results" id="roles-test-results">
                <p>Validiere Rollenkonfiguration...</p>
            </div>
        </div>

        <div class="test-summary">
            <h3 class="glitch-text" data-text="Testabdeckung [%]">Testabdeckung [%]</h3>
            <progress id="coverage-progress" value="0" max="100"></progress>
            <p id="coverage-text">Berechne Systemstabilität...</p>
        </div>

        <div class="test-actions">
            <button class="test-button" id="run-all-tests">[Alle Tests neu starten]</button>
        </div>
    </main>

    <footer>
        <p>© 2024 deepdive.Jette - Test Environment // Build v1.1</p>
    </footer>

    <!-- Netlify Identity Widget Script -->
    <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <!-- Unser Redirect-Script -->
    <script src="js/identity-redirect.js"></script>
    <!-- Funktionale Test-Skripts -->
    <script src="/js/identity-test.js"></script>
    <script>
        // Überprüfen, ob identity-test.js geladen wurde
        setTimeout(() => {
            if (!window.TestFramework) {
                const errorContainer = document.createElement('div');
                errorContainer.style.color = 'red';
                errorContainer.style.fontWeight = 'bold';
                errorContainer.style.margin = '20px';
                errorContainer.textContent = 'Fehler: identity-test.js wurde nicht geladen. Bitte prüfen Sie den Skriptpfad.';
                document.body.prepend(errorContainer);
            }
        }, 1000); // 1 Sekunde warten, um sicherzustellen, dass das Skript Zeit zum Laden hat
    </script>
</body>
</html>